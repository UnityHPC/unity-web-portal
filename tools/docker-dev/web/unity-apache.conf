<VirtualHost _default_:80>

	DocumentRoot /var/www/unity-web-portal/webroot

    <Location /panel>
        AuthType Basic
        AuthName "Unity User Panel"
        AuthUserFile /etc/apache2/.htpasswd
        Require valid-user

        SetEnv givenName "DevFirstname"
        SetEnv sn "DevLastname"
        SetEnv mail "DevName@DevDomain.com"

        RewriteEngine On
        # copy REMOTE_USER to eppn
        RewriteCond %{ENV:REMOTE_USER} (.*)
        RewriteRule .* - [E=eppn:%1]
        # substitute '@' and '.' with '_' in REMOTE_USER
        # this is only garunteed to work for the simple usernames in htpasswd
        RewriteCond %{ENV:REMOTE_USER} ^(.*)@(.*)\.(.*)$
        RewriteRule .* - [E=REMOTE_USER:%1_%2_%3]
    </Location>

    <Location /admin>
        AuthType Basic
        AuthName "Unity Admin Panel"
        AuthUserFile /etc/apache2/.htpasswd
        Require user user1_org1_test user2_org1_test user3_org1_test user4_org1_test user5_org2_test user6_org1_test user7_org1_test user8_org1_test user9_org3_test user10_org1_test user11_org1_test user12_org1_test user13_org1_test user14_org3_test

        SetEnv givenName "DevFirstname"
        SetEnv sn "DevLastname"
        SetEnv mail "DevName@DevDomain.com"

        RewriteEngine On
        # copy REMOTE_USER to eppn
        RewriteCond %{ENV:REMOTE_USER} (.*)
        RewriteRule .* - [E=eppn:%1]
        # substitute '@' and '.' with '_' in REMOTE_USER
        # this is only garunteed to work for the simple usernames in htpasswd
        RewriteCond %{ENV:REMOTE_USER} ^(.*)@(.*)\.(.*)$
        RewriteRule .* - [E=REMOTE_USER:%1_%2_%3]
    </Location>

</VirtualHost>
